<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Psion Software Index</title>
        <link rel="stylesheet" href="main.css">
    </head>
    <body>
        <h1>Psion Software Index</h1>
        <a href="https://github.com/jbmorley/psion-software-index" target="_blank">GitHub</a>

        <h2>Libraries</h2>
        <ul>
            {% for library in libraries %}
                <li>
                    {% if library.url %}<a href="{{ library.url }}">{% endif %}
                    {% if library.name %}{{ library.name }}{% else %}{{ library.path }}{% endif %}
                    {% if library.url %}</a>{% endif %}
                </li>
            {% endfor %}
        </ul>

        <h2>Summary</h2>
        <table>
            <tr>
                <td>{{ summary.installer_count }}</td>
                <td>Installers</td>
            </tr>
            <tr>
                <td>{{ summary.uid_count }}</td>
                <td>Unique UIDs</td>
            </tr>
            <tr>
                <td>{{ summary.version_count }}</td>
                <td> Unique versions</td>
            </tr>
            <tr>
                <td>{{ summary.sha_count }}</td>
                <td>Unique files</td>
            </tr>
        </table>

        <h2>Software</h2>

        <ul class="applications">
            {% for application in applications %}
                <li>
                    <div class="application-header">
                        <div class="application-name">
                            {% if application.icon %}
                                <img class="icon" src="{{ application.icon.data }}">
                            {% endif %}
                            {{ application.name }}
                        </div>
                        <div class="application-identifier">
                            {{ application.uid }}
                        </div>
                    </div>
                    {% if application.summary %}
                        <div class="summary">
                            <p>{{ application.summary }}</p>
                        </div>
                    {% endif %}
                    {% if application.readme %}
                        <details class="readme">
                            <summary>Readme</summary>
                            <div class="readme-contents">{{ application.readme | e }}</div>
                        </details>
                    {% endif %}
                    {% for version in application.versions %}
                        <div class="version-header">
                            <div class="version-name">
                                {{ version.version }}
                            </div>
                            <div class="version-details">
                                {% if version.variants | length > 1 %}
                                    {{ version.variants | count }} variants
                                {% endif %}
                            </div>
                        </div>
                        <ul>
                            {% for variant in version.variants %}
                                <li>
                                    <table class="release">
                                        {% for installer in variant.installers %}
                                            <tr>
                                                <td>{{ variant.installers[0].language_emoji }}</td>
                                                <td class="path">
                                                    {% for component in installer.reference %}
                                                        {% if component.name %}
                                                            {{ component.name }}
                                                        {% else %}
                                                            {{ component | e }}
                                                        {% endif %}
                                                        {% if not loop.last %}
                                                            &#8594;
                                                        {% endif %}
                                                    {% endfor %}
                                                </td>
                                                {% if options.show_install_buttons %}
                                                    <td><a class="install" href="{{ installer.install_url }}">Install</a></td>
                                                {% endif %}
                                            </tr>
                                        {% endfor %}
                                    </table>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endfor %}
                </li>
            {% endfor %}
        </ul>

    </body>
</html>
